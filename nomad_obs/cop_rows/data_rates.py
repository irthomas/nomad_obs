# -*- coding: utf-8 -*-
"""
Created on Mon Oct 13 16:28:13 2025

@author: iant
"""

import numpy as np

# sinbad syslogs: assume 4096 bytes per minute = 546.1333 bits per second throughout the MTP = 0.33 Gbit per week
# calculate: precooling = 242 bytes per second precooling + 226 + (24 * 320 * 1.5 ) per second science (in ITL, add together and divide by duration)

# uvis from TN, assume includes TM27, 28, 29

# extracted from ITLs, bits/s vs SO_DURATION_TIME
# import matplotlib.pyplot as plt
# ir_occ_precooling_sci = np.array([
#     [36296.2341, 695],
#     [38086.4848, 717],
#     [40285.0288, 746],
#     [42453.7163, 777],
#     [43890.6940, 799],
#     [44206.3124, 804],
#     [44455.9947, 808],
#     [44641.6401, 811],
#     [45549.6394, 826],
#     [45786.2297, 830],
#     [45962.1814, 833],
#     [46991.8396, 851],
#     # [9974.3801, 859],  # MTP097 Error in ITL, wrong number of subdomains
#     # [9937.5719, 855],  # MTP097 Error in ITL, wrong number of subdomains
#     [48298.8190, 875],
#     [49182.0436, 892],
#     [50227.6755, 913],
#     [52225.3969, 956],
#     [53051.9795, 975],
#     [53887.9625, 995],
#     [84604.9056, 4040],  # ?
#     # [81476.419, 4200],  # due to precooling length change 600->440
# ])
# plt.xlabel("[bits/sec] from the ITL")
# plt.ylabel("SO_DURATION_TIME")
# plt.grid()
# plt.scatter(ir_occ_precooling_sci[:, 0], ir_occ_precooling_sci[:, 1])


def ir_data_rate(obs_type, duration):
    """ return data volume in kbits for science and precooling"""
    if obs_type in ["ingress", "egress", "grazing"]:
        return (5.314899E+04*np.log(duration) - 3.113960E+05)/1000.0 * duration
    elif obs_type in ["calibration"]:
        # TODO: get this right
        return (84604.9056)/1000.0 * duration
    elif obs_type in ["dayside", "nightside"]:
        return (5.314899E+04*np.log(duration) - 3.113960E+05)/1000.0 * duration / 15.0
    elif obs_type in ["phobos_deimos"]:
        return (5.314899E+04*np.log(duration) - 3.113960E+05)/1000.0 * duration / 60.0


def uvis_data_rate(cop_row, duration):
    """ return data volume in kbits"""

    tno00010_iss5rev5 = np.array([
        1.4797794118,
        297.33198529,
        2.2136101974,
        20.036571428,
        254.77946099,
        5.0172000000,
        0.8830666667,
        90.421466666,
        366.06194666,
        1.4978666667,
        1.4978666667,
        55.870533333,
        0.4500000000,
        0.4500000000,
        312.92499578,
        304.95916405,
        362.67080000,
        195.32520000,
        79.024080000,
        79.024080000,
        79.024080000,
        326.91672000,
        290.35768000,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        289.29210666,
        290.35768000,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        318.34413333,
        289.29210666,
        362.67080000,
        267.84162666,
        212.05976000,
        161.85608000,
        362.67080000,
        267.84162666,
        212.05976000,
        161.85608000,
        362.67080000,
        267.84162666,
        212.05976000,
        161.85608000,
        273.41981333,
        217.63794666,
        161.85608000,
        223.21613333,
        167.43426666,
        189.74701333,
        128.38696000,
        156.27789333,
        360.32002666,
        254.36962666,
        211.98946666,
        153.71674666,
        360.32002666,
        254.36962666,
        211.98946666,
        153.71674666,
        349.72498666,
        254.36962666,
        211.98946666,
        153.71674666,
        264.96466666,
        217.28698666,
        153.71674666,
        211.98946666,
        153.71674666,
        180.20434666,
        123.65897777,
        148.41922666,
        138.79794666,
        79.333146666,
        64.466946666,
        47.948946666,
        109.06554666,
        79.873204444,
        64.466946666,
        47.948946666,
        82.636746666,
        64.466946666,
        47.948946666,
        66.118746666,
        47.948946666,
        56.207946666,
        39.689946666,
        46.297146666,
        69.571600000,
        39.772240000,
        31.494640000,
        24.872560000,
        54.671920000,
        39.772240000,
        31.494640000,
        24.872560000,
        41.427760000,
        31.494640000,
        24.872560000,
        33.150160000,
        24.872560000,
        28.183600000,
        19.906000000,
        23.217040000,
        140.22274666,
        63.461626666,
        110.18578666,
        63.461626666,
        83.486266666,
        48.443146666,
        66.799066666,
        48.443146666,
        56.786746666,
        40.099546666,
        46.774426666,
        43.532346666,
        10.393146666,
        34.211946666,
        10.393146666,
        25.927146666,
        7.2863466667,
        20.749146666,
        7.2863466667,
        17.642346666,
        6.2507466667,
        14.535546666,
        21.938800000,
        10.204600000,
        17.245120000,
        10.204600000,
        13.072960000,
        7.3362400000,
        10.465360000,
        7.3362400000,
        8.9008000000,
        6.2932000000,
        7.3362400000,
        106.03906666,
        51.252546666,
        25.700320000,
        60.124186666,
        1.9832000000,
        1.9832000000,
        1.9832000000,
        1.9832000000,
        339.12994666,
        233.17954666,
        190.79938666,
        132.52666666,
        339.12994666,
        233.17954666,
        190.79938666,
        132.52666666,
        328.53490666,
        233.17954666,
        190.79938666,
        132.52666666,
        243.77458666,
        196.09690666,
        132.52666666,
        190.79938666,
        132.52666666,
        159.01426666,
        106.03906666,
        127.22914666,
        320.39352000,
        161.87832000,
        109.03992000,
        79.318320000,
        264.25272000,
        165.18072000,
        109.03992000,
        79.318320000,
        204.80952000,
        138.76152000,
        99.132720000,
        69.411120000,
        151.97112000,
        89.225520000,
        62.806320000,
        118.94712000,
        66.108720000,
        99.132720000,
        66.108720000,
        79.318320000,
        186.70014666,
        89.243946666,
        59.511546666,
        41.341746666,
        132.19074666,
        89.243946666,
        59.511546666,
        41.341746666,
        102.45834666,
        59.511546666,
        41.341746666,
        31.430946666,
        76.029546666,
        59.511546666,
        41.341746666,
        59.511546666,
        41.341746666,
        49.600746666,
        24.823746666,
        39.689946666,
        93.576640000,
        43.911040000,
        28.183600000,
        19.906000000,
        66.260560000,
        43.911040000,
        28.183600000,
        19.906000000,
        51.360880000,
        28.183600000,
        19.906000000,
        16.594960000,
        38.116720000,
        28.183600000,
        20.733760000,
        29.839120000,
        20.733760000,
        24.872560000,
        16.594960000,
        19.906000000,
        79.551466666,
        47.766346666,
        31.873786666,
        79.551466666,
        47.766346666,
        31.873786666,
        84.848986666,
        47.766346666,
        31.873786666,
        84.848986666,
        47.766346666,
        31.873786666,
        84.848986666,
        47.766346666,
        31.873786666,
        84.848986666,
        47.766346666,
        31.873786666,
        24.823746666,
        14.912946666,
        9.9575466667,
        24.823746666,
        14.912946666,
        9.9575466667,
        24.823746666,
        14.912946666,
        9.9575466667,
        26.475546666,
        14.912946666,
        9.9575466667,
        26.475546666,
        14.912946666,
        9.9575466667,
        26.475546666,
        16.564746666,
        9.9575466667,
        13.283920000,
        7.4896000000,
        5.0063200000,
        13.283920000,
        7.4896000000,
        5.0063200000,
        13.283920000,
        7.4896000000,
        5.0063200000,
        13.283920000,
        7.4896000000,
        5.0063200000,
        13.283920000,
        7.4896000000,
        5.0063200000,
        13.283920000,
        7.4896000000,
        5.0063200000,
        2.4162666667,
        2.4162666667,
        2.4162666667,
        2.4162666667,
        318.95586666,
        318.95586666,
        318.95586666,
        284.86050666,
        284.86050666,
        284.86050666,
        242.15858666,
        242.15858666,
        242.15858666,
        180.59573333,
        180.59573333,
        180.59573333,
        324.48178666,
        324.48178666,
        324.48178666,
        289.82030666,
        289.82030666,
        289.82030666,
        246.99402666,
        246.99402666,
        246.99402666,
        225.18973333,
        225.18973333,
        225.18973333,
        241.53128000,
        241.53128000,
        241.53128000,
        204.40384000,
        204.40384000,
        204.40384000,
        164.25297333,
        164.57793333,
        164.57793333,
        113.17578666,
        113.17578666,
        113.17578666,
        159.75493333,
        159.75493333,
        159.75493333,
        57.168813333,
        57.168813333,
        57.168813333,
        364.27197333,
        364.27197333,
        364.27197333,
        247.11634666,
        247.11634666,
        247.11634666,
        162.85202666,
        162.85202666,
        162.85202666,
        63.718933333,
        63.718933333,
        63.755066666,
        3.7381333333,
        2.7986666667,
        2.0760000000,
        1.6424000000,
        1.3894666667,
        1.1365333333,
        0.8113333333,
        42.374853333,
        32.528186666,
        20.674853333,
        21.959146666,
        16.909213333,
        10.830146666,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        326.91672000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        161.00176000,
        155.70274666,
        326.91672000,
        329.44712000,
        244.01634666,
        161.00176000,
        31.430946666,
        21.520146666,
        16.564746666,
        31.430946666,
        21.520146666,
        16.564746666,
        31.430946666,
        21.520146666,
        16.564746666,
        33.082746666,
        21.520146666,
        16.564746666,
        33.082746666,
        21.520146666,
        16.564746666,
        33.082746666,
        23.171946666,
        16.564746666,
        16.594960000,
        10.800640000,
        8.3173600000,
        16.594960000,
        10.800640000,
        8.3173600000,
        16.594960000,
        10.800640000,
        8.3173600000,
        16.594960000,
        10.800640000,
        8.3173600000,
        16.594960000,
        10.800640000,
        8.3173600000,
        16.594960000,
        10.800640000,
        8.3173600000,
        100.74154666,
        68.956426666,
        53.063866666,
        100.74154666,
        68.956426666,
        53.063866666,
        106.03906666,
        68.956426666,
        53.063866666,
        106.03906666,
        68.956426666,
        53.063866666,
        106.03906666,
        68.956426666,
        53.063866666,
        106.03906666,
        68.956426666,
        53.063866666,
        10.342720000,
        7.2510400000,
        5.1899200000,
        10.342720000,
        7.2510400000,
        5.1899200000,
        10.342720000,
        7.2510400000,
        5.1899200000,
        10.342720000,
        7.2510400000,
        5.1899200000,
        10.342720000,
        7.2510400000,
        5.1899200000,
        10.342720000,
        7.2510400000,
        5.1899200000,
        5.1997466667,
        3.1338266667,
        2.3591066667,
        5.1997466667,
        3.1338266667,
        2.1008666667,
        5.1997466667,
        3.1338266667,
        2.1008666667,
        5.1997466667,
        3.1338266667,
        2.1008666667,
        5.1997466667,
        3.1338266667,
        2.1008666667,
        5.1997466667,
        3.1338266667,
        2.1008666667,
    ])

    return tno00010_iss5rev5[cop_row] * duration
